<!DOCTYPE html>
<html lang="en">

<head><link rel="stylesheet" type="text/css" href="http://www.taniarascia.com/wp-content/cache/minify/000000/M9DPT8pJLEnVTy4u1i8uqcxJ1cvNzAMA.css" media="all" />

	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="author" content="Tania Rascia">
	<meta name="description" content=" &raquo; Getting Started with AWS &#8211; Setting Up a Virtual Server - Tutorials by Tania Rascia ">
	<meta name="viewport" content="width=device-width, initial-scale=1">


		<title>Getting Started with AWS &#8211; Setting Up a Virtual Server &#8211; Tania Rascia</title>
<link rel="alternate" type="application/rss+xml" title="Tania Rascia &raquo; Getting Started with AWS &#8211; Setting Up a Virtual Server Comments Feed" href="http://www.taniarascia.com/getting-started-with-aws-setting-up-a-virtual-server/feed/" />

<link rel='stylesheet' id='OpenSans-css'  href='//fonts.googleapis.com/css?family=Open+Sans%3A400%2C600%2C700%2C800&#038;ver=4.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='NotoSerif-css'  href='//fonts.googleapis.com/css?family=Noto+Serif%3A400%2C700&#038;ver=4.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='RobotoMono-css'  href='//fonts.googleapis.com/css?family=Roboto+Mono%3A400%2C300%2C500%2C700&#038;ver=4.4.1' type='text/css' media='all' />
<link rel='https://api.w.org/' href='http://www.taniarascia.com/wp-json/' />
<link rel='prev' title='Learn Sass Now: A Guide to Installing, Using and Understanding Sass' href='http://www.taniarascia.com/learn-sass-now/' />
<link rel='next' title='Developing a WordPress Theme from Scratch Part 2: Pagination, Comments, Single Post, Functions, &#038; Custom Posts' href='http://www.taniarascia.com/wordpress-from-scratch-part-two/' />
<meta name="generator" content="WordPress 4.4.1" />
<link rel="canonical" href="http://www.taniarascia.com/getting-started-with-aws-setting-up-a-virtual-server/" />
<link rel='shortlink' href='http://www.taniarascia.com/?p=1341' />
<link rel="alternate" type="application/json+oembed" href="http://www.taniarascia.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.taniarascia.com%2Fgetting-started-with-aws-setting-up-a-virtual-server%2F" />
<link rel="alternate" type="text/xml+oembed" href="http://www.taniarascia.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.taniarascia.com%2Fgetting-started-with-aws-setting-up-a-virtual-server%2F&#038;format=xml" />

		<script>
			(function(i, s, o, g, r, a, m) {
				i['GoogleAnalyticsObject'] = r;
				i[r] = i[r] || function() {
					(i[r].q = i[r].q || []).push(arguments)
				}, i[r].l = 1 * new Date();
				a = s.createElement(o),
					m = s.getElementsByTagName(o)[0];
				a.async = 1;
				a.src = g;
				m.parentNode.insertBefore(a, m)
			})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

			ga('create', 'UA-42068444-1', 'auto');
			ga('send', 'pageview');

		</script>

</head>

<body>
	<header>
		<div class="flex vertical">
			<div class="box one-fourth">
				<a href="http://www.taniarascia.com"><img src="http://www.taniarascia.com/wp-content/themes/oblate/images/tr.png" class="logo-image" alt="Tania Rascia"></a>
			</div>
			<div class="box three-fourths social">
				<a href="https://taniarascia.github.io/new-moon"><img src="http://www.taniarascia.com/wp-content/themes/oblate/images/newmoon.png" class="darken" alt="New Moon Syntax Theme"></a>&nbsp;
				<a href="https://twitter.com/taniarascia"><img src="http://www.taniarascia.com/wp-content/themes/oblate/images/twitter.png" class="darken" alt="Twitter"></a>&nbsp;
				<a href="https://github.com/taniarascia"><img src="http://www.taniarascia.com/wp-content/themes/oblate/images/github-dark.png" class="darken" alt="GitHub"></a>&nbsp;
				<a href="http://www.taniarascia.com/feed"><img src="http://www.taniarascia.com/wp-content/themes/oblate/images/rss.png" class="darken" alt="RSS Feed"></a>
			</div>
		</div>
	</header>
	<main>
		<article id="post-1341" class="single-article">
	<div class="article-header center">
				<img src="http://www.taniarascia.com/wp-content/uploads/aws-1-150x150.png" class="article-image" alt="Getting Started with AWS &#8211; Setting Up a Virtual Server">		<h2>Getting Started with AWS &#8211; Setting Up a Virtual Server</h2>
		<time datetime="2015-12-22">
			December 22, 2015		</time>
		&nbsp;☍&nbsp;<span class="tags"><a href="http://www.taniarascia.com/tag/aws/" rel="tag">aws</a>, <a href="http://www.taniarascia.com/tag/hosting/" rel="tag">hosting</a>	</div>
	<p>Amazon Web Services, or AWS, is a set of web services provided by Amazon.com. If you&#8217;re looking for web hosting through AWS and have only had experience with managed hosting services before, there&#8217;s a lot to learn. In this tutorial, I&#8217;m going to highlight some of the most important features and services of AWS.</p>
<p>AWS is a veritable alphabet soup of acronyms, so I highly suggest you give <a href="https://www.expeditedssl.com/aws-in-plain-english" target="_blank">AWS in Plain English</a> a read through before attempting to tackle the beast.</p>
<p>The way I go about setting up a server is far from the only way to do it, but it will be a complete guide. <a href="https://aws.amazon.com/documentation/">The AWS Documentation</a> is absolutely massive, so you should be able to find any additional information there.</p>
<h4>Prerequisites</h4>
<ul>
<li><strong>Basic command line knowledge</strong> &#8211; if you&#8217;ve never used the command line before, trying to set up AWS will be a bit terrifying. I would recommend reading through the first few chapters of <a href="http://learnpythonthehardway.org/book/appendixa.html" target="_blank">The Command Line Crash Course</a> and getting comfortable before moving on to AWS.</li>
<li><strong>Ability to set up a website</strong> &#8211; you should already know HTML and CSS, and have set up a live website at some point.</li>
</ul>
<h4>Goals</h4>
<ul>
<li>Make an AWS account and learn about the key services</li>
<li>Configure AWS Security</li>
<li>Set up and configure virtual server</li>
<li>Set up a LAMP stack (Linux, Apache, MySQL, PHP)</li>
<li>Set up virtual hosts</li>
</ul>
<h3>Making an AWS Account</h3>
<p>Here&#8217;s the good news &#8211; AWS is free for a year, so you can run through this or any tutorial to get an idea of how it all works, regardless of whether or not you want to use it. </p>
<p>Go to <a href="https://aws.amazon.com/">Amazon Web Services</a> and sign up for an account. If you already have an Amazon.com account for something else (Kindle, buying stuff online) it will be the same account. You&#8217;ll choose the Basic (free) account, be prompted for your credit card and phone number, they&#8217;ll call you to confirm, and you&#8217;re in. </p>
<p><span id="more-1341"></span></p>
<p>No opening preamble &#8211; here&#8217;s the dashboard.</p>
<p><img src="http://www.taniarascia.com/wp-content/uploads/awsdashboard.png"></p>
<h3>Key AWS Services</h3>
<p>There are currently 53 services, with more being added all the time, but you most likely won&#8217;t even use close to half of them. I&#8217;ll take a moment to highlight the absolute most essentials.</p>
<p><img src="http://www.taniarascia.com/wp-content/uploads/Screen-Shot-2015-12-21-at-7.48.20-PM.png"><br />
An <strong>EC2</strong> instance (<em>Elastic Compute Cloud</em>) is a virtual server in the cloud. You have complete control over the server, what gets installed on it, the configuration, and so on. Since we&#8217;re setting up LAMP, Apache, MySQL and PHP are going to be installed on a Linux EC2 instance. </p>
<p><img src="http://www.taniarascia.com/wp-content/uploads/Screen-Shot-2015-12-21-at-7.48.08-PM.png"><br />
Amazon <strong>S3</strong> (<em>Simple Storage Service</em>) is a static file storage service. It&#8217;s like a simple web interface for FTP, in which you can host static files and also host static websites &#8211; so images, HTML, CSS, JavaScript, PDFs, mp3s, and so on, but nothing that requires a server. S3 containers are known as buckets.</p>
<p><img src="http://www.taniarascia.com/wp-content/uploads/Screen-Shot-2015-12-21-at-7.47.23-PM.png"><br />
<strong>IAM</strong> (<em>Identity &#038; Access Management</em>) will contain all the settings and security configuration your for your account. </p>
<p>There are many, many useful services here, but we should be able to get started with just these three.</p>
<h3>Securing Your Account</h3>
<p>A good idea when first creating your account is adding some additional layers of security. Go to <strong>IAM</strong> on the dashboard.</p>
<p><img src="http://www.taniarascia.com/wp-content/uploads/Screen-Shot-2015-12-21-at-7.54.13-PM.png"></p>
<h5>Activate MFA (Multi Factor Identification) on Your Root Account</h5>
<p>Download Google Authenticator on your phone, and click <strong>Manage MFA</strong>. Select <strong>Virtual MFA Device</strong>. You&#8217;ll scan a QR code with the Google Authenticator app. Type the random numbers that pop up into the input, and your device will be associated with the account. Now no one can log in to your root account without also having your phone.</p>
<h5>Create Individual IAM Users</h5>
<p>Go to <strong>Users</strong> and <strong>Create User</strong>. Make a username for yourself. User Security Credentials will also be generated when you create the user, so save or download the <strong>Access Key ID</strong> and <strong>Secret Access Key</strong> they give you. At some point, these will come in handy, so it&#8217;s a good idea to make them right off the bat. Create a password for your user under <strong>Security Credentials</strong>.</p>
<p>Reason for users, according to AWS: </p>
<blockquote><p>Create IAM users and give them only the permissions they need. Do not use your AWS root account for day-to-day interaction with AWS, because the root account provides unrestricted access to your AWS resources.</p></blockquote>
<h5>Create Groups</h5>
<p>At this point, I&#8217;m going to go to <strong>Groups</strong>, create a group called <strong>Developer</strong>, and grant <strong>AdministratorAccess</strong>. Obviously, if you had a bigger team, you could allow access only to certain services, but since it&#8217;s just me, I&#8217;m going to give it full access. </p>
<h5>Create a Password Policy</h5>
<p>In <strong>Account Settings</strong>, you can set a password policy (or leave it as is), and your security setup is complete.</p>
<p><img src="http://www.taniarascia.com/wp-content/uploads/Screen-Shot-2015-12-21-at-8.15.55-PM.png"></p>
<h5>Create an Account Alias</h5>
<p>Finally, how do we log in with the user we just created? You&#8217;ll notice at the top of the IAM dashboard, there&#8217;s a horrible link:</p>
<p><strong>IAM users sign-in link:</strong><br />
<ins>https://stuff.signin.aws.amazon.com/console</ins></p>
<p>Change it to something you&#8217;ll remember. Log out of your account, and go to <ins>https://your-alias.signin.aws.amazon.com/console</ins>. From here, you&#8217;ll log in with the credentials of the user you created before &#8211; you should no longer log in as root user.</p>
<p>Hopefully you feel pretty secure at this point, so we can finally move on.</p>
<h3>Setting up an EC2 Instance</h3>
<p>We&#8217;re going to set up a Linux EC2 instance. The default settings for a Linux server do not allow access via password &#8211; they use Key Pairs. If you want to change that later you can (although it&#8217;s not recommended), but it&#8217;s necessary to generate a key pair to begin.</p>
<h5>Generate Key Pair</h5>
<p>Go to <strong>EC2</strong>, and click on <strong>Key Pairs</strong>. Generate a key pair, and call it whatever you want. <strong>Your_Key.pem</strong> will get saved to your downloads folder. Move the pem file from your <strong>Downloads</strong> folder to your <strong>.ssh</strong> directory, located in your main user directory. The whole URL to your pem file should be:</p>
<pre><code>~/.ssh/Your_Key.pem</code></pre>
<p>You can technically move this file anywhere, it doesn&#8217;t need to be located in the <strong>.ssh</strong> directory to function.</p>
<h5>Create a VPC</h5>
<p>An instance requires a <strong>VPC</strong> (<em>Virtual Private Cloud</em>). Your region might contain a default VPC &#8211; mine did. You can check this by going to the <strong>EC2 dashboard</strong> and checking the settings on the right side for <strong>Default VPC</strong>. If it doesn&#8217;t exist, <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/get-set-up-for-amazon-ec2.html#create-a-vpc" target="_blank">set one up</a>.</p>
<h5>Create Security Group</h5>
<p>In the <strong>EC2 dashboard</strong>, click on <strong>Security Groups</strong>. You will see one already created by default, but we&#8217;ll make a new one to get accustomed to it.</p>
<p>Set a name (such as <em>username_SG_region</em>) and apply it to the default VPC (should be the only one). </p>
<p>On <strong>Inboard</strong>, add rule:<br />
<strong>Type</strong>: HTTP<br />
<strong>Source</strong>: Anywhere (0.0.0.0/0)</p>
<p><strong>Type</strong>: HTTPS<br />
<strong>Source</strong>: Anywhere (0.0.0.0/0)</p>
<p><strong>Type</strong>: SSH<br />
<strong>Source</strong>: My IP</p>
<p>You can select the <strong>My IP</strong> option, or type &#8220;whats my ip&#8221; in Google to get your IP and type it in. These rules are telling the EC2 instance to allow inbound access to the internet (0.0.0.0/0) but only allow SSH access from your IP. You can technically set SSH access to the internet as well, just know that it&#8217;s a reduction in security.</p>
<h3>Launching an EC2 Instance</h3>
<p>The setup for creating an EC2 instance is complete, so now we can launch. Go to <strong>Instances</strong>. It will tell you there are no instances set up, so click <strong>Launch Instance</strong>. </p>
<p>This will launch a quick start guide.</p>
<h5>Choose an AMI</h5>
<p>An AMI (<em>Automated Machine Image</em>) is a template for an instance. Later you can save your completed instance and launch new ones based on your configuration with an AMI. For now, we&#8217;re going to use the first option on the list, which is an Amazon Linux AMI.</p>
<p><img src="http://www.taniarascia.com/wp-content/uploads/Screen-Shot-2015-12-21-at-9.02.14-PM.png" alt="Screen Shot 2015-12-21 at 9.02.14 PM"></p>
<h5>Choose Instance Type</h5>
<p>Different instance types will provide different specs for CPU, memory, performance, and so on. The free-tier instance type is <strong>t2.micro</strong>, so select that and click <strong>Next &#8211; Configure Instance Details</strong>.</p>
<h5>Configure Instance Details</h5>
<p><strong>Number of Instances</strong>: 1<br />
<strong>Network</strong>: Default VPC<br />
<strong>Auto-assign Public IP</strong>: Disable (we&#8217;ll set an elastic IP in a second)<br />
<strong>IAM Role</strong>: Create New IAM Role &#8211; you don&#8217;t need to do this, but you can&#8217;t set a role after you create an instance, so I&#8217;m going to create a role and give it AmazonEC2FullAccess.<br />
<strong>Shutdown Behavior</strong>: Stop</p>
<p>You can protect against accidental termination if you&#8217;d like.</p>
<p>You can skip past <strong>Add Storage</strong> and <strong>Tag Instance</strong> for now. </p>
<h5>Configure Security Group</h5>
<p>Select the security group you created before, with full HTTP and HTTPS access, and SSH access only from your IP.</p>
<p><strong>Review and Launch</strong> then <strong>Launch</strong>. You will be prompted to enter a key pair, which will be the one you created earlier. Accept the terms and launch.</p>
<h3>Connecting to an EC2 Instance</h3>
<p>Back in the <strong>EC2 dashboard</strong>, if you go to <strong>Instances</strong> you&#8217;ll see the new instance set up with all your specs. It takes a few minutes to initialize. </p>
<p>You can right-click on the empty space under <strong>Name</strong> and set a name to your instance. This is how it will look when it&#8217;s ready.</p>
<p><img src="http://www.taniarascia.com/wp-content/uploads/Screen-Shot-2015-12-21-at-9.24.47-PM.png"></p>
<h5>Create an Elastic IP</h5>
<p>Earlier I didn&#8217;t create a public IP for the instance. Now I&#8217;m going to go to <strong>Elastic IPs</strong>. Click <strong>Allocate New Address</strong>. Under <strong>Actions</strong>, select <strong>Associate Address</strong> and apply it to the instance you just created. </p>
<blockquote><p>An Elastic IP will remain yours even if you shut down the instance, while a regular public IP won&#8217;t.</p></blockquote>
<p>Now we can SSH into our instance and start installing services. Open <strong>Terminal</strong>. Find your &#8220;Public DNS&#8221; in your instance description. It will look something like <ins>ec2-00-00-00-00.us-region-0.compute.amazonaws.com</ins>. </p>
<p>The default user for AWS Linux is <strong>ec2-user</strong>. At this point, many people attempt to SSH to the server with the following:</p>
<pre><code>ssh ec2-user@PublicDNS</code></pre>
<div class="terminal">The authenticity of host &#8220;xxx&#8221; can&#8217;t be established.<br />
ECDSA key fingerprint is &#8220;xxx&#8221;.<br />
Are you sure you want to continue connecting? (yes/no)</div>
<p>At this point, you will enter:</p>
<pre><code>yes</code></pre>
<div class="terminal">Warning: Permanently added &#8220;xxx&#8221; to list of known hosts.<br />
Permission denied (publickey).</div>
<p>As I mentioned before, the default settings for Linux require a public and private key match to log in, not password authentication. Now type the following:</p>
<pre><code>chmod 400 ~/.ssh/Your_key.pem</code></pre>
<p>Permissions need to be set to 400 before you can use the key.</p>
<pre><code>ssh -i ~/.ssh/Your_Key.pem ec2-user@PublicDNS</code></pre>
<p>And you&#8217;re in!</p>
<pre><div class="terminal">
       __|  __|_  )
       _|  (     /   Amazon Linux AMI
      ___|\___|___|

https://aws.amazon.com/amazon-linux-ami/2015.09-release-notes/</div></pre>
<p>First thing you can do is update the packages.</p>
<pre><code>sudo yum update -y</code></pre>
<p>You will install all the security packages that have come out for AWS since the AMI was launched. Now your instance is secure and up to date.</p>
<p>If you&#8217;ve never used Linux, <strong>yum</strong> is <em>Yellowdog Updater, Modified</em>, and it&#8217;s the primary package manager for Linux. You can easily install many services through yum.</p>
<p>With one command, you can install Apache, MySQL, and PHP.</p>
<pre><code>sudo yum install -y httpd24 php56 mysql55-server php56-mysqlnd</code></pre>
<p>You can also install them one at a time &#8211; <code>yum install httpd24</code> installs Apache 2.4, <code>yum install php56</code> install PHP 5.6, etc. </p>
<p>If you simply ran <code>yum install php</code>, you would end up installing PHP 5.3, the default version of PHP, which came out in 2009. I&#8217;d prefer the instance to be more up to date, so I&#8217;m using the AWS LAMP stack recommendations.</p>
<p>Now start Apache.</p>
<pre><code>sudo service httpd start</code></pre>
<p>And make sure it starts on each boot.</p>
<pre><code>sudo chkconfig httpd on</code></pre>
<p>Paste the URL of the Public DNS into your browser, and you&#8217;ll get this:</p>
<p><img src="http://www.taniarascia.com/wp-content/uploads/Screen-Shot-2015-12-21-at-10.51.35-PM.png"></p>
<p>I&#8217;m also going to install <strong>git</strong> because it will come in handy.</p>
<pre><code>sudo yum install git</code></pre>
<p>Start MySQL. Later, you might decide to use RDS (<em>Relational Database Service</em>) for your database needs, but for now we can install MySQL on the server.</p>
<pre><code>sudo service mysqld start</code></pre>
<p>Now we&#8217;ll configure MySQL safely according to the AWS specifications.</p>
<pre><code>sudo mysql_secure_installation</code></pre>
<p>It will prompt you for the root password, which is blank, so press <kbd>enter</kbd>. You&#8217;ll type <code>y</code> about 5 times until the configuration is complete. </p>
<p>Prompt MySQL to load on boot.</p>
<pre><code>sudo chkconfig mysqld on</code></pre>
<p>Install phpMyAdmin.</p>
<pre><code>sudo yum-config-manager --enable epel
sudo yum install -y phpMyAdmin</code></pre>
<p>Edit the phpMyAdmin configuration file.</p>
<p>Find this:</p>
<pre><code class="language-apacheconf">&lt;Directory /usr/share/phpMyAdmin/&gt;
  &lt;IfModule !mod_authz_core.c&gt;
    # Apache 2.2
    Order Deny,Allow
    Deny from All
    Allow from 127.0.0.1
    Allow from ::1
  &lt;/IfModule&gt;
&lt;/Directory&gt;</code></pre>
<p>If you want to be able to access phpMyAdmin from any IP, change it to this:</p>
<pre><code class="language-apacheconf">Order Allow,Deny
Allow from All</code></pre>
<p>The preferred security method would be to add your IP to the bottom of the list and leave the other settings as is.</p>
<pre><code class="language-apacheconf">Allow from YOUR_IP</code></pre>
<p>Also modify this configuration.</p>
<pre><code class="language-apacheconf">&lt;RequireAny&gt;
  #Require ip 127.0.0.1
  #Require ip ::1
  Require all granted
&lt;/RequireAny&gt;</code></pre>
<p>phpMyAdmin should work now when you go to <ins>http://PublicDNS/phpmyadmin</ins>. </p>
<p><img src="http://www.taniarascia.com/wp-content/uploads/Screen-Shot-2015-12-22-at-12.21.52-AM.png"></p>
<p>You can login with <strong>root</strong> and the password you set earlier.</p>
<h5>Create a new user</h5>
<p>Let&#8217;s create a new user so we&#8217;re not using the default <strong>ec2-user</strong>. Log in as sudo (root) user.</p>
<pre><code>sudo su</code></pre>
<p>Create user. I&#8217;ll call it <strong>your-user</strong>.</p>
<pre><code>useradd your-user</code></pre>
<p>Set a password for the new user.</p>
<pre><code>passwd</code></pre>
<p>Enter the password twice.</p>
<p>Now, if I&#8217;m using SFTP as well as SSH, I&#8217;ll want to be able to access the Public HTML folder (<code>/var/www/html</code>) with my user. You can&#8217;t <code>sudo</code> in SFTP, so we&#8217;ll need to assign a group to the <code>www</code> directory as well as the new user.</p>
<h5>Modify New User Permissions</h5>
<p>Create a <code>www</code> group.</p>
<pre><code>groupadd www</code></pre>
<p>Add group to new user.</p>
<pre><code>usermod -a -G www your-user</code></pre>
<p>Run the following commands.</p>
<pre><code>chown -R root:www /var/www

chmod 2775 /var/www

find /var/www -type d -exec sudo chmod 2775 {} + 

find /var/www -type f -exec sudo chmod 0664 {} +</code></pre>
<p>Now user <strong>your-user</strong> will be able to write in the <code>www</code> directory.</p>
<h5>Give New User SSH Access</h5>
<p>Open a new local Terminal window. Run this command to get the public key from your pem file.</p>
<pre><code>ssh-keygen -y</code></pre>
<p>When it prompts you for the URL, <code>~/ssh/Your_Key.pem</code> won&#8217;t work. Instead, write out the full path.</p>
<pre><code>/Users/you/.ssh/Your_Key.pem</code></pre>
<p>Now the public key should come up. It will start with <code>ssh-rsa</code> and include a long string. Save it.</p>
<p>Back in your AWS Instance Terminal, change users to the new one you created.</p>
<pre><code>sudo su - your-user</code></pre>
<p>You&#8217;ll be in the <code>/home/your-user</code> directory. Make a directory for your public key to live and set the proper permissions.</p>
<pre><code>mkdir .ssh
chmod 700 .ssh</code></pre>
<p>Create <code>authorized_keys</code> and give it the proper permissions.</p>
<pre><code>touch .ssh/authorized_keys
chmod 600 .ssh/authorized_keys</code></pre>
<p>Add the public key to the <code>authorized_keys</code> configuration.</p>
<pre><code>nano .ssh/authorized_keys</code></pre>
<p>Paste the keys, <kbd>CTRL + O, Enter, CTRL + X</code> to save and exit.</p>
<p>Now <strong>your-user</strong> has permissions to SSH into your instance!</p>
<h5>Give User Sudo Access</h5>
<p>An easy way to give your new user sudo access is to run this command as root:</p>
<pre><code>sudo usermod -aG wheel your-user</code></pre>
<pre><code>visudo</code></pre>
<p>Press <kbd>i</kbd> on the keyboard to enter Insert Mode. Find <code># %wheel  ALL=(ALL)       ALL</code> and uncomment it (remove the #). Save and exit by pressing <kbd>exit</kbd>, and typing <code>:wq!</code> plus <kbd>enter</kbd>.</p>
<h5>SFTP into Instance</h5>
<p>If you want to SFTP into the instance, you can use the same Server (Public DNS) and username (your-user), and select key instead of password, linking to Your_Key.pem. </p>
<blockquote style="border:1px solid #7CB3EF;border-radius:4px;background: #d7e8fa;padding:15px;font-weight:normal;"><h5 style="margin-bottom:1em;">So you want SSH and SFTP access without using a keypair? </h5>
<p style="font-weight:400 !important;margin-bottom:1em;">It's possible to enter SSH and SFTP with a password instead of a keyfile. This way you can access the server on any computer without special credentials. Obviously, this is usually advised against, but here's how to do it.</p>
<p style="font-weight:400 !important;margin-bottom:1em;">Back in the Security Groups, ensure that SSH has access from (0.0.0.0/0), and not just your IP.</p>
<p style="font-weight:400 !important;margin-bottom:1em;">Edit the SSH configuration file with <code>nano /etc/ssh/sshd_config</code>. Find <code>#PasswordAuthentication yes</code> and uncomment. There might be another PasswordAuthentication below it, make sure it's set to yes.   </p>
<p style="font-weight:400 !important;margin-bottom:1em;">Restart SSH by running <code>sudo /etc/init.d/sshd restart</code>. Now you can log in from any IP with the command <code>ssh your-user@PublicDNS</code>, it will prompt you for a password, and you will be entered.</div>
</blockquote>
<h3>Setting Up Virtual Hosts</h3>
<p>Your public html folder is located in <code>/var/www/html</code>. Anything that is visible to the public should be located there. I've created a folder through SFTP called <code>example</code>. I'm also going to create a <code>000</code> folder, to be the localhost directory.</p>
<p>Edit the Apache configuration file.</p>
<pre><code>nano /etc/httpd/conf/httpd.conf</code></pre>
<p>Find <code>AllowOverride None</code> in <code>&lt;Directory "/var/www/html"&gt;</code> and change to <code>AllowOverride All</code>.</p>
<p>Add virtual hosts by adding this to the bottom of the file.</p>
<pre><code class="language-apacheconf">NameVirtualHost *:80

&lt;VirtualHost *:80&gt;
    ServerName localhost
    DocumentRoot /var/www/html/000
&lt;/VirtualHost&gt;

&lt;VirtualHost *:80&gt;
  ServerName www.example.com
  ServerAlias example.com *.example.com
  DocumentRoot /var/www/html/example 
&lt;/VirtualHost&gt;</code></pre>
<p>Save and exit. Now edit the hosts file.</p>
<pre><code>nano /etc/hosts</code></pre>
<p>And add as many hosts as you want.</p>
<pre><code class="language-apacheconf">127.0.0.1    dev.example.com
127.0.0.1    example.com</code></pre>
<p>Remember to run <code>service httpd restart</code> after any Apache configuration change.</p>
<p>This will send the Public DNS to the <code>000</code> folder, and <code>example.com</code> and any related subdomain to the <code>example</code> folder.</p>
<p>You can create <code>index.php</code> in the <code>000</code> folder, and make it something simple to ensure php is functioning, and the localhost directive is pointing to the right place.</p>
<pre><code class="language-php">&lt;?php echo '&lt;h1&gt;AWS Linux&lt;/h1&gt;'; ?&gt;</code></pre>
<p><img src="http://www.taniarascia.com/wp-content/uploads/Screen-Shot-2015-12-22-at-12.48.17-AM.png"></p>
<p>Easy enough. </p>
<p>Maybe you already have a DNS located somewhere that you can make a test with. I'm going to make <code>dev.example.com</code> point to AWS. I can do this by going to my host, finding the DNS settings, and creating a DNS Resource Record.</p>
<p><strong>Name</strong>: dev.example.com<br />
<strong>Type</strong>: CNAME<br />
<strong>TTL</strong>: 300<br />
<strong>Target</strong>: PublicDns</p>
<p>If you don't have a DNS or host already around that you can play around with, <strong>Route 53</strong> on the AWS dashboard is where they take care of all DNS related entries.</p>
<p><img src="http://www.taniarascia.com/wp-content/uploads/Screen-Shot-2015-12-22-at-12.55.21-AM.png"></p>
<h3>Transferring Files to EC2</h3>
<p>At this point, I have SFTP set up, so I can transfer files over the old fashioned way, with Transmit or Coda. But I'm going to do something even easier, and pull the code from a Git repo, since it's already up there.</p>
<pre><code>git init
git remote add origin https://repo.git
git pull origin master</code></pre>
<p>Now when I go to my site, all my files are there and the site is live.</p>
<h3>Conclusion</h3>
<p>You should have been able to run through this entire article without once referring to StackOverflow or Google to look up a command or explanation. If that's not the case, then I need to revise and improve the article. </p>
<p>Hopefully some of the aspects of setting up a server in AWS have been clarified, and you feel excited to explore more of AWS. If this article provides helpful, I'll look into making guides for setting up static hosting with AWS, databases in the cloud with RDS, setting up WordPress, setting up a CDN with CloudFront, load balancing multiple instances, and so on.</p>
<h3>Where Things are Located In Linux</h3>
<p><strong>Public HTML</strong> - <code>/var/www/html</code><br />
<strong>Apache Configuration</strong> - <code>/etc/httpd/conf/httpd.conf</code><br />
<strong>Hosts</strong> - <code>/etc/hosts</code><br />
<strong>phpMyAdmin Configuration</strong> - <code>etc/httpd/conf.d/phpMyAdmin.conf</code><br />
<strong>SSH Configuration</strong> - <code>/etc/ssh/sshd_config</code></p>
		<div class="alert">
			<a href="http://twitter.com/intent/tweet?text=Getting Started with AWS &#8211; Setting Up a Virtual Server&url=http://www.taniarascia.com/getting-started-with-aws-setting-up-a-virtual-server/&via=taniarascia" target="_blank" title="Share to Twitter" class="block"><img src="http://www.taniarascia.com/wp-content/themes/oblate/images/twitter.png" class="block-i" alt="Share this article"> Share this article!</a>
		</div>
</article>
	<div id="comments" class="comments-area">

		
				
										<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/getting-started-with-aws-setting-up-a-virtual-server/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="http://www.taniarascia.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8"  aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" value="" size="30" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="text" value="" size="30" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='1341' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="3d6e86ab58" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="40"/></p>				</form>
					</div><!-- #respond -->
		
	</div>
	<!-- .comments-area -->

				</main>
	<aside>
</aside>		<footer>
  <div class="container">
    <h1><a href="http://www.taniarascia.com/me">♥ Tania Rascia</a></h1>
  </div>
</footer>
<script type="text/javascript" src="http://www.taniarascia.com/wp-content/cache/minify/000000/M9RPzM4szk0t0Y_PzEvWT8svygUA.js"></script>
<script type='text/javascript'>
/* <![CDATA[ */
var PowerStatsParams = {"ajaxurl":"http:\/\/www.taniarascia.com\/wp-admin\/admin-ajax.php","ci":"YTo0OntzOjEyOiJjb250ZW50X3R5cGUiO3M6NDoicG9zdCI7czo4OiJjYXRlZ29yeSI7czo5OiIyLDYsMzAsMzEiO3M6MTA6ImNvbnRlbnRfaWQiO2k6MTM0MTtzOjY6ImF1dGhvciI7czo4OiJoaS10YW5pYSI7fQ==.97da8bd54060f1a8e28c34a2994a8b92"};
/* ]]> */
</script>
<script type="text/javascript" src="http://www.taniarascia.com/wp-content/cache/minify/000000/M9QvL9AtyC9PLdItLkksKUbj6hjo5yflJJak6mcV6xcUZRbn6piAlKTmJqWm6OVm5gEA.js"></script>
</body>

  </html>

<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Minified using disk
Page Caching using disk: enhanced

 Served from: www.taniarascia.com @ 2016-01-26 23:01:55 by W3 Total Cache -->